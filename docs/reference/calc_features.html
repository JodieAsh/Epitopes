<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Calculate features for epitope prediction — calc_features • epitopes</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate features for epitope prediction — calc_features"><meta property="og:description" content="This function is used to calculate several distinct families of features for
epitope prediction."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">epitopes</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.9.9018</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Usage-example.html">Usage example</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/fcampelo/epitopes/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate features for epitope prediction</h1>
    <small class="dont-index">Source: <a href="https://github.com/fcampelo/epitopes/blob/HEAD/R/calc_features.R" class="external-link"><code>R/calc_features.R</code></a></small>
    <div class="hidden name"><code>calc_features.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function is used to calculate several distinct families of features for
epitope prediction.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">calc_features</span><span class="op">(</span>
  <span class="va">peptides.list</span>,
  local.features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,
  global.features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>peptides.list</dt>
<dd><p>list object returned by <code><a href="make_data_splits.html">make_data_splits()</a></code>.</p></dd>
<dt>local.features</dt>
<dd><p>list of features to be calculated
at the local neighbourhood (<code>peptides.list$df$Info_window</code>) level.</p></dd>
<dt>global.features</dt>
<dd><p>lists of features to be calculated
at the global level (<code>peptides.list$proteins$TSeq_sequence</code>).
See <strong>Feature Lists</strong> for details.</p></dd>
<dt>...</dt>
<dd><p>any other parameters (currently unused)</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Updated <code>peptides.list</code> object, with local features added as columns
to <code>peptides.list$df</code>, and global features added as columns to
<code>peptides.list$proteins</code>.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Two major types of features can be calculated:</p><ul><li><p><em>local features</em>, which are calculated based on the local
neighbourhood of each AA position (column <em>Info_window</em> of the windowed
data frame).</p></li>
<li><p><em>global features</em>, which are calculated using the full sequence
of the protein (listed in column <em>TSeq_sequence</em>  of the protein
data frame).</p></li>
</ul><p>The following features are calculated based on the implementations available
in package
<a href="https://cran.r-project.org/package=protr" class="external-link"><strong>protr</strong></a>. As of August 2021,
the following groups of features are supported by the <strong>epitopes</strong> package
(see the <a href="https://CRAN.R-project.org/package=protr/vignettes/protr.html#3_package_overview" class="external-link">protr vignette</a>
for details on each of these):</p><ul><li><p>"AAC" - Amino acid composition</p></li>
<li><p>"DC"  - Dipeptide composition</p></li>
<li><p>"TC"  - Tripeptide composition</p></li>
<li><p>CTD descriptors:</p><ul><li><p>"CTDC" - Composition</p></li>
<li><p>"CTDT" - Transition</p></li>
<li><p>"CTDD" - Distribution</p></li>
</ul></li>
<li><p>"CTriad" - Conjoint triad descriptors</p></li>
<li><p>Quasi-sequence-order descriptors:</p><ul><li><p>"SOCN" - Sequence-order-coupling number (with maximum lag
<code>nlag = 3</code>)</p></li>
<li><p>"QSO" - Quasi-sequence-order descriptors (with maximum lag
<code>nlag = 3</code> and weighting factor <code>w = 0.1</code>)</p></li>
</ul></li>
<li><p>Proteochemometric Modeling descriptors:</p><ul><li><p>"ScalesGap" - Scales-based descriptors derived by Principal
Components Analysis (using all properties in the <code><a href="https://nanx.me/protr/reference/AAindex.html" class="external-link">protr::AAindex</a></code>
matrix, <code>pc = 5</code> and <code>lag = 3</code>)</p></li>
</ul></li>
</ul><p><strong>NOTE</strong>: in all feature groups except "ScalesGap", invalid AA codes
(B, J, O, U, X, Y) are removed from the strings prior to feature calculation.
In "ScalesGap" these codes are replaced by a gap indicator, "-".</p>
<p>Besides those, the following features are also available based on native
implementations:</p><ul><li><p>"Entropy" - the Shannon entropy of a sequence.</p></li>
<li><p>"Atoms" - the number of C, H, N, O, S atoms in the sequence</p></li>
<li><p>"MolWeight" - the total molecular weight of the sequence</p></li>
<li><p>"AAtypes" - the proportion of AAs of each type (acidic, aliphatic,
acidic, etc.)</p></li>
<li><p>"BLOSUM" - BLOSUM-derived descriptors (same as
<code><a href="https://nanx.me/protr/reference/extractBLOSUM.html" class="external-link">protr::extractBLOSUM()</a></code> with <code>submat = "AABLOSUM62"</code>,
<code>k = 5</code>, <code>lag = 3</code> and <code>scale = TRUE</code>)</p></li>
<li><p>"LegacyFeatures" - calculates the features used in paper
doi: <a href="https://doi.org/10.1093/bioinformatics/btab536" class="external-link">10.1093/bioinformatics/btab536</a></p></li>
</ul><p>Each feature group may be used either at the local or global level -
which does not mean it <em>should</em> be. The <strong>protr</strong> documentation provides
the following warning: "<em>Users need to intelligently evaluate the underlying</em>
<em>details of the descriptors provided, instead of using protr with their data</em>
<em>blindly, especially for the descriptor types with more flexibility. It</em>
<em>would be wise for the users to use some negative and positive control</em>
<em>comparisons where relevant to help guide interpretation of the results.</em>".
Users should therefore be savvy when choosing which features to use for epitope
prediction, and the choice should ideally be guided by domain expertise.
Certain feature groups may not make sense as local features,
as the (usually very short) local substrings will not allow the features to
be informative (e.g., tripeptide composition, "TC"); or may require
specific overriding of standard parameters (e.g., parameter
<code>lambda</code> for "PAAC" must be smaller than the length of the shortest local
string).</p>
<p><strong>IMPORTANT</strong>: if the splitting level intended to be used for modelling is
"peptide" (this can be checked in <code>peptides.list$splits.attrs$split_level</code>)
then global features should be avoided, as their use can result in
data leakage across splits and contaminate performance calculations.</p>
    </div>
    <div id="feature-vectors">
    <h2><strong>Feature Vectors</strong></h2>
    

<p>Input vectors <code>local.features</code> and <code>global.features</code> are used to define
which features are calculated at either level. These input parameters must be
character vectors, where each element is one of the names listed in
<strong>Details</strong>. For more information on the features calculated by <strong>protr</strong>,
check <code>?protr::extractXYZ</code>, replacing <code>XYZ</code> by the group abbreviation (see
<strong>Details</strong> or the documentation of the <strong>protr</strong> package for the list of
available feature groups). Notice that, for consistency purposes, the user
parameters of all <strong>protr</strong> features are kept fixed in this routine.
If the user wishes to add other features (or the same features with distinct
parameters) they can calculate those separately
and bind them to <code>peptides.list$df</code> (for local features) or
<code>peptides.list$proteins</code> (for global ones). All feature columns should have
names starting with "feat_local_" or "feat_global_".</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Felipe Campelo (<a href="mailto:f.campelo@aston.ac.uk">f.campelo@aston.ac.uk</a>)</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Felipe Campelo.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

